
Процедура ВыводТаблицы(тз)
	ТабДок = ЭлементыФормы.ПолеТабличногоДокумента1;
	ТабДок.Очистить();
	Макет = ПолучитьМакет("Макет");
	Шапка = Макет.ПолучитьОбласть("Шапка");
	Строка = Макет.ПолучитьОбласть("Строка");
	ТабДок.Вывести(Шапка);	

	ИндексСледСтрока = 1;
	Для каждого запись из тз цикл   		
		попытка		
			Номенклатура = запись.Номенклатура;
			Количество = запись.Количество;
			Месяц = запись.Месяц;	 					
			Строка.Параметры[Месяц]= Количество;
			НоменклатураСлед = тз[ИндексСледСтрока].Номенклатура;
						
			Если Номенклатура <> НоменклатураСлед тогда	
				Строка.Параметры.Номенклатура = Номенклатура;				
			 	ТабДок.Вывести(Строка);
				Строка = Макет.ПолучитьОбласть("Строка"); 
			КонецЕсли;
				
		исключение
			Строка.Параметры.Номенклатура = Номенклатура;
		 	ТабДок.Вывести(Строка);

		конецпопытки;
    	ИндексСледСтрока = ИндексСледСтрока + 1;
	КонецЦикла;
		
	ТабДок.Показать();
	

КонецПроцедуры

 Процедура СозданиеТаблицы()
	 
	ТабИсходная = Новый ТаблицаЗначений;   	
	ТабИсходная.Колонки.Добавить("Номенклатура");
	ТабИсходная.Колонки.Добавить("Количество");
	ТабИсходная.Колонки.Добавить("Месяц"); 
	 
	Таб = Новый ТаблицаЗначений;   	
	Таб.Колонки.Добавить("Номенклатура");
	Таб.Колонки.Добавить("Количество");
	Таб.Колонки.Добавить("Месяц");
	

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 1";
	Стр.Количество = "5";
	Стр.Месяц = "Апрель";
	
	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 3";
	Стр.Количество = "5";
	Стр.Месяц = "Апрель";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 10";
	Стр.Количество = "2";
	Стр.Месяц = "Май";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 1";
	Стр.Количество = "1";
	Стр.Месяц = "Июль";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 2";
	Стр.Количество = "5";
	Стр.Месяц = "Июнь";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 3";
	Стр.Количество = "5";
	Стр.Месяц = "Август";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 7";
	Стр.Количество = "8";
	Стр.Месяц = "Сентябрь";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 1";
	Стр.Количество = "5";
	Стр.Месяц = "Март";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 6";
	Стр.Количество = "7";
	Стр.Месяц = "Октябрь"; 

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 11";
	Стр.Количество = "14";
	Стр.Месяц = "Октябрь";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 4";
	Стр.Количество = "10";
	Стр.Месяц = "Ноябрь";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 4";
	Стр.Количество = "12";
	Стр.Месяц = "Октябрь";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 4";
	Стр.Количество = "23";
	Стр.Месяц = "Август";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 9";
	Стр.Количество = "3";
	Стр.Месяц = "Декабрь";

	Стр = ТабИсходная.Добавить();
	Стр.Номенклатура = "поз. 4";
	Стр.Количество = "21";
	Стр.Месяц = "Декабрь";

	Для каждого запись из ТабИсходная цикл  	
		запись.Номенклатура = Число(Сред(запись.Номенклатура,6,2));		
	КонецЦикла;

	ТабИсходная.Сортировать("Номенклатура");
	
	Для каждого запись из ТабИсходная цикл  	
		запись.Номенклатура = Строка("поз. " + запись.Номенклатура);		
	КонецЦикла; 
			
КонецПроцедуры

                                                                                                
 
Процедура КнопкаСформироватьНажатие(Кнопка)
	СозданиеТаблицы();
	ВыводТаблицы(ТабИсходная);	
КонецПроцедуры 


Процедура ПриИзменении(Элемент)
	ПараметрыОтбора = Новый Структура; 
	ПроверкаЗаполненияПолей = Ложь;
	Если ЗначениеЗаполнено(ПолеКоличество) тогда
		ПроверкаЗаполненияПолей = Истина;
		ПараметрыОтбора.Вставить("Количество", Строка(ПолеКоличество));
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ПолеНоменклатура) тогда
		 ПроверкаЗаполненияПолей = Истина;
		 ПараметрыОтбора.Вставить("Номенклатура", Строка(ПолеНоменклатура));
	КонецЕсли;
	
	Если ПроверкаЗаполненияПолей тогда
	 найдСтроки = ТабИсходная.НайтиСтроки(ПараметрыОтбора);
	 Таб = ТабИсходная.Скопировать(найдСтроки);
	 ВыводТаблицы(Таб);
 	Иначе
	   ВыводТаблицы(ТабИсходная);
	 КонецЕсли;
  КонецПроцедуры

